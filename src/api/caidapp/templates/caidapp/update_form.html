{% extends 'base.html' %}
{% load widget_tweaks %}

{% block head %}
{#    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>#}
    <!-- Bootstrap JS -->
{#<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"#}
{#        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"#}
{#        crossorigin="anonymous"></script>#}
    {{ form.media }}
    <!-- Include jQuery -->
        <script>
        $(document).ready(function() {
            console.log('document is ready');
            $('#myForm').on('submit', function() {
                console.log('form is submitted');
                $('#loadingModal').modal('show');
            });
        });
    </script>

{% endblock %}

{% block body %}
    {#<div class="container">#}
    {% if user.is_authenticated %}
        <div class="pagetitle">
            <h1>{{ headline }}</h1>
            <nav>
                {% if nav_dict %}
                    <ol class="breadcrumb">
                        {% for key, value in nav_dict.items %}
                            <li class="breadcrumb-item"><a href="{{ value }}">{{ key }}</a></li>
                        {% endfor %}
                    </ol>
                {% endif %}
{#                    <li class="breadcrumb-item"><a href="{% url 'caidapp:uploads' %}">Uploads</a></li>#}
{#                    <li class="breadcrumb-item"><a href="{% url 'caidapp:uploadedarchive_mediafiles' mediafile.parent.id %}"> Uploaded#}
{#                        Archive: {{ mediafile.parent }}</a></li>#}
{#                </ol>#}
            </nav>
        </div><!-- End Page Title -->
        <div class="section">

            <div class="row">
                <div class="col-md-6">
{#                    <div class="card">#}
{#                        <div class="card-body">#}


                            <form id="myForm" method="post" enctype="multipart/form-data">
                                {% csrf_token %}

                                {# this is passing th nex page from GET to POST to be applicable when the form is ok  #}
                                <input type="hidden" name="next" value="{{ request.GET.next }}">

{#                                {{ form.as_p }}#}
                                {% for field in form %}
                                    <div class="form-group">
                                        <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                                        {{ field.errors }}
                                        {% if field.field.widget.input_type == "checkbox" %}
                                            {{ field|add_class:"form-check-input" }}
                                        {% else %}
                                            {{ field|add_class:"form-control" }}
                                        {% endif %}

                                    </div>
                                {% endfor %}
                                {#                {{ form.as_p }}#}
                                <button class="btn btn-primary mt-2" id="btnUpload" type="submit">
                                    {{ button }}
                                </button>
                                {% if cancel_button_url %}
                                    <a class="btn btn-secondary mt-2"
                                       href="{{ cancel_button_url }}">
{#                                        <i class="bi bi-"></i> #}
                                        Cancel
                                    </a>
                                {% endif %}
                                {% if delete_button_url %}
                                    <a class="btn btn-danger mt-2"
                                       href="{{ delete_button_url }}"
                                            {#                               href="{% url 'caidapp:delete_upload' uploadedarchive.id %}"#}
                                       onclick="return confirm('Delete {{ form.instance }}?')">
                                        <i class="bi bi-trash"></i> Delete
                                    </a>
                                {% endif %}

                            </form>
{#                        </div>#}
{#                    </div>#}
                </div>
                {% if text_note %}
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body mt-4">
                            {{ text_note }}
                        </div>
                    </div>

                </div>
                {% endif %}
                {% if mediafile or right_col_raw_html or right_col_links or mediafiles %}
                <div class="col-md-6">
                {% if mediafile %}
                        <img src="{{ mediafile.thumbnail.url }}" alt="{{ mediafile.name }}" class="img-thumbnail">
{#                    <div class="card">#}
{#                        <div class="card-body">#}
{#                        </div>#}
{#                    </div>#}

                {% endif %}
                    {% if mediafiles %}
{#                        carousel of with three mediafiles mediafiles#}

                        <div id="mediafileCarousel" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-inner">
                                {% for mf in mediafiles %}
                                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                        <img src="{{ mf.thumbnail.url }}" class="d-block w-100 img-thumbnail" alt="{{ mf.name }}">
                                    </div>
                                {% endfor %}
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#mediafileCarousel" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#mediafileCarousel" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    {% endif %}
                {% if right_col_raw_html %}
                    {{ right_col_raw_html|safe }}
                {% endif %}
                    {% if right_nav %}
                    <div class="mt-3">
{#                        <div class="card-body">#}
                            <ul class="list-group">
                                {% for name, link in right_nav.items %}
                                    {% if link %}
                                        <li class="list-group-item"><a class="link-secondary" href="{{ link }}">{{ name }}</a></li>
                                    {% else %}
{#                                        headline #}
                                        <li class="list-group-item"><h4>{{ name }}</h4></li>
                                    {% endif %}

                                {% endfor %}
                            </ul>
{#                        </div>#}
                    </div>
                    {% endif %}
                {% endif %}
                </div>

            </div>
        </div>
    {% endif %}
    {#</div>#}
{% endblock %}