{% extends 'base.html' %}
{% load static %}
{% block head %}
    <style>
        /* Custom breakpoint for screens larger than 1920px (you can adjust the value as needed) */
        @media (min-width: 1920px) {
            .col-xxxl-1 {
                flex: 0 0 auto;
                width: 8.33%; /* 1/12th of the width */
            }
            .col-xxxl-2 {
                flex: 0 0 auto;
                width: 16.66%; /* 2/12th of the width */
            }
            .col-xxxl-3 {
                flex: 0 0 auto;
                width: 25%; /* 3/12th of the width */
            }
            .col-xxxl-4 {
                flex: 0 0 auto;
                width: 33.33%; /* 4/12th of the width */
            }
            .col-xxxl-6 {
                flex: 0 0 auto;
                width: 50%; /* 6/12th of the width */
            }
        }



        .card {
            display: flex;
            flex-direction: column;
        }

        .card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
    </style>
{% endblock %}
{% block body %}
    {% if user.is_authenticated %}

        <div class="pagetitle">
            <h1>Localities</h1>
        <nav>
            <a href="{% url 'caidapp:export_localities' %}" class="btn btn-secondary">
                <i class="fas fa-file-export"></i> Export CSV
            </a>
            <a href="{% url 'caidapp:export_localities_xls' %}" class="btn btn-secondary">
                <i class="fas fa-file-excel"></i>
                Export XLSX
            </a>
            <a href="{% url 'caidapp:import_localities' %}" class="btn btn-secondary">
                <i class="fas fa-file-import"></i> Import spreadsheet
            </a>
            <a href="{% url 'caidapp:update_locality' %}" class="btn btn-secondary">
                <i class="fas fa-plus"></i> Add new locality
            </a>
        </nav>

        </div><!-- End Page Title -->
        <section class="section">
        <div class="row" id="row-of-cards">

            {% if localities %}
                {% for locality in localities %}
                    <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-4 col-xxl-3 col-xxxl-2" id="card{{ locality.id }}">
                        {#                        <div class="col" style="-ms-flex: 0 0 200; flex: 0 0 200;">#}
                        <div class="card">
                            {% if locality.uploadedarchive_set.all.0 %}
                                {% if locality.uploadedarchive_set.all.0.thumbnail %}
                                    <img
                                            class="card-img-top"
                                            src="{{ locality.uploadedarchive_set.all.0.thumbnail.url }}"
                                            alt="Camera trap image"
                                    >
                                {% endif %}
                            {% endif %}
                            <div class="card-body">
                                <h5 class="card-title">
                                    {%  if request.session.private_mode %}
                                        {{ locality.visible_name }}
                                    {% else %}
                                        {{ locality.name }}
                                    {% endif %}
                                    {% if locality.location %}
                                        <i class="fas fa-map-marker-alt"></i>
                                    {% endif %}

                                </h5>
                                <p class="card-text">

                                    <a href="{% url 'caidapp:uploads_of_locality' locality.hash %}" class="link-secondary"
                                       data-bs-toggle="tooltip" title="Camera Trap Checks"
                                    >
                                    Camera trap checks: {{ locality.uploadedarchive_set.count }}
                                    </a>
                                </p>
                            </div>
                            <div class="card-footer">
                                <a href="{% url 'caidapp:update_locality' locality.id %}" class="btn btn-primary"
                                        {%  if request.session.private_mode %}
                                            onclick="return confirm('You are in private mode. In edit view you will reveal the locality. Do you want to continue?')"
                                        {% endif %}
                                >
                                    <i class="fas fa-edit"></i> Edit
                                    </a>
                                <a href="{% url 'caidapp:media_files_locality' locality.hash %}" class="btn btn-secondary" >
                                    <i class="fas fa-images"></i> Media files
                                </a>
                                <a href="{% url 'caidapp:uploads_of_locality' locality.hash %}" class="btn btn-secondary"
                                   data-bs-toggle="tooltip" title="Camera Trap Checks"
                                >
{#                                    <i class="fas fa-images"></i> Media files#}
                                    Checks
                                </a>
                            </div>

{#                            {{ locality.uploadedarchive_set.all.0.thumbnail.url }}#}
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
        </section>

    {% endif %}
{% endblock %}