{% extends "base.html" %}

{% block content %}
  <h1>Merge Identities Suggestion</h1>
  <form method="post" action="{% url 'caidapp:merge_selected_identities' %}">
    {% csrf_token %}
    {% if suggestions %}
        <div class="mt-3 mb-3 d-flex justify-content-between">
            <button type="submit" class="btn btn-primary"
                    onclick="return confirm('Are you sure you want to merge the selected suggestions?');">
                Merge Selected
            </button>

            <a class="btn btn-secondary" href="{% url 'caidapp:refresh_merge_identities_suggestions' %}">
                <i class="bi bi-arrow-clockwise"></i>
                Refresh
            </a>

        </div>
      <ul class="list-group">
      {% for identity1, identity2, distance in suggestions %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div class="form-check">
            <input class="form-check-input" type="checkbox"
                   name="suggestions"
                   value="{{ identity1.id }}|{{ identity2.id }}"
                   id="suggestion-{{ identity1.id }}-{{ identity2.id }}">
            <label class="form-check-label" for="suggestion-{{ identity1.id }}-{{ identity2.id }}">
                <a href="{% url 'caidapp:update_individual_identity' identity1.id %}" class="link-secondary">
                    {{ identity1.name }} ({{ identity1.code }})
                </a>
                &rarr;
                <a href="{% url 'caidapp:update_individual_identity' identity1.id %}" class="link-secondary">
                    {{ identity2.name }} ({{ identity2.code }})
                </a>
            </label>
          </div>
          <div class="d-flex align-items-center">
            <div class="me-5">
              distance: {{ distance }}
            </div>
            <a class="btn btn-secondary me-1"
               href="{% url 'caidapp:merge_identities' identity1.id identity2.id %}">
              Merge with preview
            </a>
            <a class="btn btn-secondary"
               href="{% url 'caidapp:merge_identities_no_preview' identity1.id identity2.id %}"
               onclick="return confirm('Are you sure you want to merge {{ identity1.name }} into {{ identity2.name }}?');">
              Merge
            </a>
          </div>
        </li>
      {% endfor %}
      </ul>
    {% else %}
      <p>No suggestions available.</p>
    {% endif %}
  </form>
{% endblock %}







{#{% extends "base.html" %}#}
{##}
{#{% block content %}#}
{#  <h1>Merge Identities Suggestion</h1>#}
{##}
{#  {% if suggestions %}#}
{#      <ul class="list-group">#}
{#      {% for locality1, locality2, distance in suggestions %}#}
{#        <li class="list-group-item d-flex justify-content-between align-items-center">#}
{#          {{ locality1.name }} ({{ locality1.code }}) => {{ locality2.name }} ({{ locality2.code }})#}
{#            <div class="d-flex align-items-center">#}
{#                <div class="me-5">#}
{#                    distance: {{ distance }}#}
{#                </div>#}
{#          <a class="btn btn-secondary me-1" href="{% url 'caidapp:merge_identities' locality1.id locality2.id %}"#}
{#          onclick="return confirm('Are you sure you want to merge {{ locality1.name }} into {{ locality2.name }}?');"#}
{#          >Merge with preview</a>#}
{#                <a class="btn btn-secondary" href="{% url 'caidapp:merge_identities_no_preview' locality1.id locality2.id %}"#}
{#                   onclick="return confirm('Are you sure you want to merge {{ locality1.name }} into {{ locality2.name }}?');"#}
{#                >Merge</a>#}
{#            </div>#}
{#        </li>#}
{#      {% endfor %}#}
{#      </ul>#}
{##}
{##}
{#  {% endif %}#}
{#{% endblock %}#}