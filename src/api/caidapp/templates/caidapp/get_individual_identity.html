{% extends 'base.html' %}

{% block body %}
    {% with col_style="col-md" %}
    {#<div class="container">#}
    {% if user.is_authenticated %}
        <div class="pagetitle">
            <h1>{{ headline }}</h1>
            <nav>
                <ol class="breadcrumb">
                    {#                    <li class="breadcrumb-item"><a href="{% url 'caidapp:uploads' %}">Uploads</a></li>#}
                    {#                    <li class="breadcrumb-item"><a href="{% url 'caidapp:uploadedarchive_detail' mediafile.parent.id %}"> Uploaded#}
                    {#                        Archive: {{ mediafile.parent }}</a></li>#}
                </ol>
            </nav>
        </div><!-- End Page Title -->

        <div class="section">
        {% if foridentifications %}
                <div class="row" id="row-of-cards">

{#                   Unknown image#}
                    <div class="{{ col_style }} me-5" id="card{{ mediafile.id }}">
                        <div class="card">
                            <img class="card-img-top" src="{{ foridentification.mediafile.mediafile.url }}"
                                 alt="Camera trap image">
                            <div class="card-body">
                                <div class="card-title">
                                    Unknown
                                </div>
                                <p class="card-text">
                                from <a href="{% url 'caidapp:uploadedarchive_detail' foridentification.mediafile.parent.id %}" class="link-secondary"> {{ foridentification.mediafile.parent }}</a>
                                </p>

                                <p class="card-text">
                                    {{ foridentifications|length }} media files left to identify.
                                </p>


                                {#                            <img class="card-img-bottom" src="{{ foridentification.mediafile.mediafile.url }}"#}
                                {#                                 class="card-img-bottom" alt="Camera trap image">#}
                                <a href="{% url 'caidapp:get_individual_identity' %}" class="btn btn-secondary">Skip</a>
                                <a href="{% url 'caidapp:remove_foridentification' foridentification.id %}" class="btn btn-danger"
                                   onclick="return confirm('Remove mediafile from list for identification?')"><i class="fa fa-trash"></i></a>
                            </div>
                        </div>
                    </div>

{#                Top 1 #}
                    <div class="{{ col_style }}" id="card{{ mediafile.id }}">
                        <div class="card">
                            <img class="card-img-top" src="{{ foridentification.top1mediafile.mediafile.url }}"
                                 class="card-img-top" alt="Camera trap image">
    {#                        <div class="card-header">#}
                             <div class="card-body">
                                <div class="card-title">
                                    {{ foridentification.top1name }}
                                </div>
                                <p class="card-text">
                                    {{ foridentification.top1score|floatformat:2 }}
                                </p><p class="card-text">
                                    {% if foridentification.top1mediafile.identity %}
{#                                        <a href="{% url 'caidapp:set_individual_identity' foridentification.id foridentification.top1mediafile.identity.id %}" class="stretched-link"> </a>#}
                                          <a href="{% url 'caidapp:set_individual_identity' foridentification.id foridentification.top1mediafile.identity.id %}" class="btn btn-primary">Select</a>
                                          <a href="{% url 'caidapp:get_individual_identity_zoomed' foridentification.id 1 %}" class="btn btn-secondary"><i class="bi bi-search"></i></a>
                                    {% else %}
                                        Identity does not exist
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="{{ col_style }}" id="card{{ mediafile.id }}">
                        <div class="card">
    {#                        <div class="card-header">#}
                            <img class="card-img-top" src="{{ foridentification.top2mediafile.mediafile.url }}"
                                 class="card-img-top" alt="Camera trap image">
                            <div class="card-body">
                                <div class="card-title">
                                    {{ foridentification.top2name }}
                                </div>
                                <p class="card-text">
                                    {{ foridentification.top2score|floatformat:2 }}
    {#                                {{ foridentification.top2mediafile.identity.id }}#}
    {#                                {{ foridentification.top2score }}#}
                                </p><p class="card-text">
                                    {% if foridentification.top2mediafile.identity %}
{#                                        <a href="{% url 'caidapp:set_individual_identity' foridentification.id foridentification.top2mediafile.identity.id %}" class="stretched-link"> </a>#}
                                        <a href="{% url 'caidapp:set_individual_identity' foridentification.id foridentification.top2mediafile.identity.id %}" class="btn btn-primary">Select</a>
                                        <a href="{% url 'caidapp:get_individual_identity_zoomed' foridentification.id 2 %}" class="btn btn-secondary"><i class="bi bi-search"></i></a>
                                    {% else %}
                                        Identity does not exist
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="{{ col_style }}" id="card{{ mediafile.id }}">
                        <div class="card">
                            <img class="card-img-top" src="{{ foridentification.top3mediafile.mediafile.url }}"
                                 class="card-img-top" alt="Camera trap image">
                            <div class="card-body">
                                <div class="card-title">
                                    {{ foridentification.top3name }}
                                </div>
                                <p class="card-text">
                                    {{ foridentification.top3score|floatformat:2 }}
                                </p><p class="card-text">
                                    {% if foridentification.top3mediafile.identity %}
{#                                        <a href="{% url 'caidapp:set_individual_identity' foridentification.id foridentification.top3mediafile.identity.id %}" class="stretched-link"> </a>#}
                                        <a href="{% url 'caidapp:set_individual_identity' foridentification.id foridentification.top3mediafile.identity.id %}" class="btn btn-primary">Select</a>
                                        <a href="{% url 'caidapp:get_individual_identity_zoomed' foridentification.id 3 %}" class="btn btn-secondary"><i class="bi bi-search"></i></a>
                                    {% else %}
                                        Identity does not exist
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
        {% else %}
            <p>No media files left to identify.</p>
        {% endif %}
        </div>
    {% endif %}
    {#</div>#}
    {% endwith %}
{% endblock %}