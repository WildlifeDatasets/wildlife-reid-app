<ul class="dropdown-menu">

    {% with next_step_structure=uploadedarchive.next_processing_step_structure %}
        {% if next_step_structure %}
            <li>
                <a class="dropdown-item"
                   href={{ next_step_structure.1 }}>
                    <i class="bi bi-arrow-right"></i>
                    {{ next_step_structure.0 }}
                </a>
            </li>
        {% endif %}
    {% endwith %}
    <li>
        <a class="dropdown-item"
           href="{% url 'caidapp:uploadedarchive_detail' uploadedarchive.id %}">
            <i class="bi bi-info"></i> Info
        </a>
    </li>
    <li>
        <a class="dropdown-item"
           href="{% url 'caidapp:update_uploadedarchive' uploadedarchive.id %}">
            <i class="bi bi-pencil"></i> Edit
        </a>
    </li>
    <li>
        <a class="dropdown-item"
           href="{% url 'caidapp:missing_taxon_annotation_in_uploadedarchive' uploadedarchive.id %}">
            <i class="bi bi-pencil"></i> Annotate missing taxons
        </a>
    </li>
    {#                                                {% if uploadedarchive.zip_file %}#}
    {#                                                    <li><a class="dropdown-item"#}
    {#                                                           href="{{ uploadedarchive.zip_file.url }}"><i#}
    {#                                                            class="bi bi-download"></i> Download images</a></li>#}
    {#                                                {% endif %}#}
    {#                                                {% if uploadedarchive.csv_file %}#}
    <li><a class="dropdown-item"
           href="{% url 'caidapp:download_uploadedarchive_csv' uploadedarchive.id %}"><i
            class="bi bi-table"></i> Download CSV </a></li>
    {#                                                {% endif %}#}
    <li><a class="dropdown-item"
           href="{% url 'caidapp:download_uploadedarchive_xlsx' uploadedarchive.id %}"><i
            class="fas fa-file-excel"></i> Download XLSX </a></li>
{#    <li><a class="dropdown-item"#}
{#           href="{% url 'caidapp:download_zip_for_mediafiles' uploadedarchive.id %}"><i#}
{#            class="bi bi-archive"></i> Download media files 1</a></li>#}
    <li><a class="dropdown-item download-mediafiles-button"
           data-id="{{ uploadedarchive.id }}"
           href="#"><i
            class="bi bi-archive"></i> Download media files</a></li>
    <li>
        <a class="dropdown-item"
           href="{% url 'caidapp:select_taxon_for_identification' uploadedarchive.id %}">
            <i class="fa-solid fa-hippo"></i> Go to identification</a>
    </li>
    <li>
        <a class="dropdown-item"
           href="{% url 'caidapp:verify_taxa' uploadedarchive.id %}">
            <i class="bi bi-check"></i>
            Verify taxons </a>
    </li>
    {% if request.user.is_staff or request.session.impersonate_user_id %}
        <li>
            <hr class="dropdown-divider">
        </li>
        {% if uploadedarchive.archivefile%}
            <li><a class="dropdown-item"
                   href="{{ uploadedarchive.archivefile.url }}"><i
                    class="bi bi-download"></i> Download uploaded archive</a></li>
        {% endif %}
        <li>
            <a class="dropdown-item"
               href="{{ uploadedarchive.metadata_csv_url }}">
                <i class="bi bi-table"></i> Download internal taxon processing CSV
            </a>
        </li>
{#        <li>#}
{#            <a class="dropdown-item"#}
{#               href="{{ uploadedarchive.outputdir.url }}/metadata.csv">#}
{#                <i class="bi bi-table"></i> Download internal taxon processing CSV#}
{#            </a>#}
{#        </li>#}
        <li>
            <a class="dropdown-item"
               href="{% url 'caidapp:run_processing' uploadedarchive.id %}">
                <i class="bi bi-arrow-clockwise"></i> Run taxon classification
            </a>
        </li>

        <li>
            <a class="dropdown-item"
               href="{% url 'caidapp:run_taxon_classification_force_init' uploadedarchive.id %}">
                <i class="bi bi-arrow-clockwise"></i> Run taxon classification (force_init)
            </a>
        </li>

        <li>
            <a class="dropdown-item"
               href="{% url 'admin:caidapp_uploadedarchive_change' uploadedarchive.id %}">
                <i class="bi bi-pencil"></i>
                Edit in admin
            </a>
        </li>
        {#                                                <li>#}
        {#                                                    <a class="dropdown-item"#}
        {#                                                       href="{% url 'caidapp:run_identification' uploadedarchive.id %}">#}
        {#                                                        <i class="bi bi-fingerprint"></i> Run identification#}
        {#                                                    </a>#}
        {#                                                </li>#}
    {% endif %}
    <li>
        <hr class="dropdown-divider">
    </li>
    <li><a class="dropdown-item text-danger"
           href="{% url 'caidapp:delete_upload' uploadedarchive.id 'caidapp:uploads' %}"
           onclick="return confirm('Delete file {{ uploadedarchive }}?')">
        <i class="bi bi-trash"></i> Delete
    </a></li>
</ul>
