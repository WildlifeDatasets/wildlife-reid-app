{% extends 'base.html' %}

{% block body %}
    {#<div class="container">#}
    {% if user.is_authenticated %}
        <div class="pagetitle">
            <div style="display: flex; justify-content: space-between">

                <div>
                    <h1>{{ headline }}</h1>
                    <nav>
                        <ol class="breadcrumb">
                            {% if mediafile.parent.contains_single_taxon %}
                                <li class="breadcrumb-item"><a href="{% url 'caidapp:uploads_identities' %}">Identities Uploads </a></li>
                            {% else %}
                                <li class="breadcrumb-item"><a href="{% url 'caidapp:uploads' %}"> Taxon Uploads</a></li>
                            {%  endif %}
                            <li class="breadcrumb-item"><a href="{% url 'caidapp:uploadedarchive_mediafiles' mediafile.parent.id %}"> Uploaded
                                Archive: {{ mediafile.parent }}</a></li>
                        </ol>
                    </nav>
                </div>
                <div>

                    <div class="dropdown mt-3">
                        {#                                <div class="dropdown d-inline-block">#}
                        <a class="btn btn-secondary dropdown-toggle" href="#" role="button"
                           data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-three-dots"></i>
                        </a>

                        <ul class="dropdown-menu">
                            {% if request.user.is_staff %}

                                <li>
                                    <a class="dropdown-item"
                                       href="{% url 'admin:caidapp_mediafile_change' mediafile.id %}">
                                        <i class="bi bi-lock"></i>
                                        Edit in admin
                                    </a>
                                </li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                            {% endif %}
                            <li>

                                {#                                            download mediafile#}
                                <a class="dropdown-item"
                                   href="{{ mediafile.mediafile.url }}" download>
                                    <i class="bi bi-download"></i> Download mediafile
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-danger"
                                   href="{% url 'caidapp:delete_mediafile' mediafile.id %}"
                                   onclick="return confirm('Delete file {{ mediafile }}?')">
                                    <i class="bi bi-trash"></i> Delete
                                </a>

                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div><!-- End Page Title -->
        <div class="section">
            <div class="row">
                <div class="col-lg-4 col-xl-2">
                    <div class="card">
                        {#                <div class="card-header">#}
                        {#                </div>#}
                        <div class="card-body">
                            <div style="display: flex; justify-content: space-between">
                                <form method="post" enctype="multipart/form-data" class="mt-3">
                                    {% csrf_token %}
{#                                    {{ form }}#}
                                                    {{ form.as_p }}
                                    <button class="btn btn-primary" id="btnUpload" type="submit">
                                        {{ button }}
                                    </button>

                                    {% if mediafile.is_for_suggestion %}
                                        <i class="bi bi-question-circle"></i>
                                        Is it {{ mediafile.predicted_taxon  }} ({{ mediafile.predicted_taxon_confidence|floatformat:4 }}) ?
                                        <button name="confirmTaxonSubmit" class="btn btn-primary" id="confirmTaxonSubmit" type="submit">
                                        Confirm
                                        </button>
{#                                        <a href="#" class="btn btn-secondary confirm-prediction" data-id="{% url 'caidapp:confirm_prediction' mediafile.id %}">Confirm</a>#}
                                    {% endif %}

                                </form>



                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8 col-xl-10">
            {% if mediafile.media_type == 'video' %}
                <video controls width="640" height="360">
{#                    <source src="{% url 'caidapp:stream_video' mediafile.id %}" type="video/mp4">#}
                    <source src="{% url 'caidapp:stream_video' mediafile.id %}" type="video/x-m4v">
                    Your browser does not support the video tag.
                </video>

            {% else %}
                <img src="{{ mediafile.mediafile.url }}" class="img-fluid" alt="Camera trap image">
            {% endif  %}
                </div>
            </div>
        </div>
    {% endif %}
    {#</div>#}
{% endblock %}